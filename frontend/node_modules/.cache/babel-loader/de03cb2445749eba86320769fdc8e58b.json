{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar prop_types_1 = __importDefault(require(\"prop-types\"));\n\nvar react_1 = __importDefault(require(\"react\"));\n\nvar FileDrop =\n/** @class */\nfunction (_super) {\n  __extends(FileDrop, _super);\n\n  function FileDrop(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.resetDragging = function () {\n      _this.frameDragCounter = 0;\n\n      _this.setState({\n        draggingOverFrame: false,\n        draggingOverTarget: false\n      });\n    };\n\n    _this.handleWindowDragOverOrDrop = function (event) {\n      // This prevents the browser from trying to load whatever file the user dropped on the window\n      event.preventDefault();\n    };\n\n    _this.handleFrameDrag = function (event) {\n      // Only allow dragging of files\n      if (!FileDrop.eventHasFiles(event)) return; // We are listening for events on the 'frame', so every time the user drags over any element in the frame's tree,\n      // the event bubbles up to the frame. By keeping count of how many \"dragenters\" we get, we can tell if they are still\n      // \"draggingOverFrame\" (b/c you get one \"dragenter\" initially, and one \"dragenter\"/one \"dragleave\" for every bubble)\n      // This is far better than a \"dragover\" handler, which would be calling `setState` continuously.\n\n      _this.frameDragCounter += event.type === 'dragenter' ? 1 : -1;\n\n      if (_this.frameDragCounter === 1) {\n        _this.setState({\n          draggingOverFrame: true\n        });\n\n        if (_this.props.onFrameDragEnter) _this.props.onFrameDragEnter(event);\n        return;\n      }\n\n      if (_this.frameDragCounter === 0) {\n        _this.setState({\n          draggingOverFrame: false\n        });\n\n        if (_this.props.onFrameDragLeave) _this.props.onFrameDragLeave(event);\n        return;\n      }\n    };\n\n    _this.handleFrameDrop = function (event) {\n      if (!_this.state.draggingOverTarget) {\n        _this.resetDragging();\n\n        if (_this.props.onFrameDrop) _this.props.onFrameDrop(event);\n      }\n    };\n\n    _this.handleDragOver = function (event) {\n      if (FileDrop.eventHasFiles(event)) {\n        _this.setState({\n          draggingOverTarget: true\n        });\n\n        if (!FileDrop.isIE() && _this.props.dropEffect) event.dataTransfer.dropEffect = _this.props.dropEffect;\n        if (_this.props.onDragOver) _this.props.onDragOver(event);\n      }\n    };\n\n    _this.handleDragLeave = function (event) {\n      _this.setState({\n        draggingOverTarget: false\n      });\n\n      if (_this.props.onDragLeave) _this.props.onDragLeave(event);\n    };\n\n    _this.handleDrop = function (event) {\n      if (_this.props.onDrop && FileDrop.eventHasFiles(event)) {\n        var files = event.dataTransfer ? event.dataTransfer.files : null;\n\n        _this.props.onDrop(files, event);\n      }\n\n      _this.resetDragging();\n    };\n\n    _this.handleTargetClick = function (event) {\n      if (_this.props.onTargetClick) {\n        _this.props.onTargetClick(event);\n      }\n\n      _this.resetDragging();\n    };\n\n    _this.stopFrameListeners = function (frame) {\n      if (frame) {\n        frame.removeEventListener('dragenter', _this.handleFrameDrag);\n        frame.removeEventListener('dragleave', _this.handleFrameDrag);\n        frame.removeEventListener('drop', _this.handleFrameDrop);\n      }\n    };\n\n    _this.startFrameListeners = function (frame) {\n      if (frame) {\n        frame.addEventListener('dragenter', _this.handleFrameDrag);\n        frame.addEventListener('dragleave', _this.handleFrameDrag);\n        frame.addEventListener('drop', _this.handleFrameDrop);\n      }\n    };\n\n    _this.frameDragCounter = 0;\n    _this.state = {\n      draggingOverFrame: false,\n      draggingOverTarget: false\n    };\n    return _this;\n  }\n\n  FileDrop.prototype.componentDidMount = function () {\n    this.startFrameListeners(this.props.frame);\n    this.resetDragging();\n    window.addEventListener('dragover', this.handleWindowDragOverOrDrop);\n    window.addEventListener('drop', this.handleWindowDragOverOrDrop);\n  };\n\n  FileDrop.prototype.UNSAFE_componentWillReceiveProps = function (nextProps) {\n    if (nextProps.frame !== this.props.frame) {\n      this.resetDragging();\n      this.stopFrameListeners(this.props.frame);\n      this.startFrameListeners(nextProps.frame);\n    }\n  };\n\n  FileDrop.prototype.componentWillUnmount = function () {\n    this.stopFrameListeners(this.props.frame);\n    window.removeEventListener('dragover', this.handleWindowDragOverOrDrop);\n    window.removeEventListener('drop', this.handleWindowDragOverOrDrop);\n  };\n\n  FileDrop.prototype.render = function () {\n    var _a = this.props,\n        children = _a.children,\n        className = _a.className,\n        targetClassName = _a.targetClassName,\n        draggingOverFrameClassName = _a.draggingOverFrameClassName,\n        draggingOverTargetClassName = _a.draggingOverTargetClassName;\n    var _b = this.state,\n        draggingOverTarget = _b.draggingOverTarget,\n        draggingOverFrame = _b.draggingOverFrame;\n    var fileDropTargetClassName = targetClassName;\n    if (draggingOverFrame) fileDropTargetClassName += \" \" + draggingOverFrameClassName;\n    if (draggingOverTarget) fileDropTargetClassName += \" \" + draggingOverTargetClassName;\n    return react_1.default.createElement(\"div\", {\n      className: className,\n      onDragOver: this.handleDragOver,\n      onDragLeave: this.handleDragLeave,\n      onDrop: this.handleDrop\n    }, react_1.default.createElement(\"div\", {\n      className: fileDropTargetClassName,\n      onClick: this.handleTargetClick\n    }, children));\n  };\n\n  FileDrop.isIE = function () {\n    return typeof window !== 'undefined' && (window.navigator.userAgent.indexOf('MSIE') !== -1 || window.navigator.appVersion.indexOf('Trident/') > 0);\n  };\n\n  FileDrop.eventHasFiles = function (event) {\n    // In most browsers this is an array, but in IE11 it's an Object :(\n    var hasFiles = false;\n\n    if (event.dataTransfer) {\n      var types = event.dataTransfer.types;\n\n      for (var keyOrIndex in types) {\n        if (types[keyOrIndex] === 'Files') {\n          hasFiles = true;\n          break;\n        }\n      }\n    }\n\n    return hasFiles;\n  };\n\n  FileDrop.propTypes = {\n    className: prop_types_1.default.string,\n    targetClassName: prop_types_1.default.string,\n    draggingOverFrameClassName: prop_types_1.default.string,\n    draggingOverTargetClassName: prop_types_1.default.string,\n    onDragOver: prop_types_1.default.func,\n    onDragLeave: prop_types_1.default.func,\n    onDrop: prop_types_1.default.func,\n    onTargetClick: prop_types_1.default.func,\n    dropEffect: prop_types_1.default.oneOf(['copy', 'move', 'link', 'none']),\n    frame: function (props, propName, componentName) {\n      var prop = props[propName];\n\n      if (prop == null) {\n        return new Error('Warning: Required prop `' + propName + '` was not specified in `' + componentName + '`');\n      }\n\n      if (prop !== document && !(prop instanceof HTMLElement)) {\n        return new Error('Warning: Prop `' + propName + '` must be one of the following: document, HTMLElement!');\n      }\n    },\n    onFrameDragEnter: prop_types_1.default.func,\n    onFrameDragLeave: prop_types_1.default.func,\n    onFrameDrop: prop_types_1.default.func\n  };\n  FileDrop.defaultProps = {\n    dropEffect: 'copy',\n    frame: typeof window === 'undefined' ? undefined : window.document,\n    className: 'file-drop',\n    targetClassName: 'file-drop-target',\n    draggingOverFrameClassName: 'file-drop-dragging-over-frame',\n    draggingOverTargetClassName: 'file-drop-dragging-over-target'\n  };\n  return FileDrop;\n}(react_1.default.PureComponent);\n\nexports.FileDrop = FileDrop;","map":{"version":3,"sources":["../src/FileDrop.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,YAAA,GAAA,eAAA,CAAA,OAAA,CAAA,YAAA,CAAA,CAAA;;AACA,IAAA,OAAA,GAAA,eAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA;;AA6BA,IAAA,QAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAA8B,EAAA,SAAA,CAAA,QAAA,EAAA,MAAA,CAAA;;AA0D5B,WAAA,QAAA,CAAY,KAAZ,EAAgC;AAAhC,QAAA,KAAA,GACE,MAAA,CAAA,IAAA,CAAA,IAAA,EAAM,KAAN,KAAY,IADd;;AA6BA,IAAA,KAAA,CAAA,aAAA,GAAgB,YAAA;AACd,MAAA,KAAI,CAAC,gBAAL,GAAwB,CAAxB;;AACA,MAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,iBAAiB,EAAE,KAArB;AAA4B,QAAA,kBAAkB,EAAE;AAAhD,OAAd;AACD,KAHD;;AAKA,IAAA,KAAA,CAAA,0BAAA,GAA6B,UAAC,KAAD,EAAiB;AAC5C;AACA,MAAA,KAAK,CAAC,cAAN;AACD,KAHD;;AAKA,IAAA,KAAA,CAAA,eAAA,GAAkB,UAAC,KAAD,EAAiB;AACjC;AACA,UAAI,CAAC,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAL,EAAoC,OAFH,CAIjC;AACA;AACA;AACA;;AACA,MAAA,KAAI,CAAC,gBAAL,IAAyB,KAAK,CAAC,IAAN,KAAe,WAAf,GAA6B,CAA7B,GAAiC,CAAC,CAA3D;;AAEA,UAAI,KAAI,CAAC,gBAAL,KAA0B,CAA9B,EAAiC;AAC/B,QAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,iBAAiB,EAAE;AAArB,SAAd;;AACA,YAAI,KAAI,CAAC,KAAL,CAAW,gBAAf,EAAiC,KAAI,CAAC,KAAL,CAAW,gBAAX,CAA4B,KAA5B;AACjC;AACD;;AAED,UAAI,KAAI,CAAC,gBAAL,KAA0B,CAA9B,EAAiC;AAC/B,QAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,iBAAiB,EAAE;AAArB,SAAd;;AACA,YAAI,KAAI,CAAC,KAAL,CAAW,gBAAf,EAAiC,KAAI,CAAC,KAAL,CAAW,gBAAX,CAA4B,KAA5B;AACjC;AACD;AACF,KArBD;;AAuBA,IAAA,KAAA,CAAA,eAAA,GAAkB,UAAC,KAAD,EAAiB;AACjC,UAAI,CAAC,KAAI,CAAC,KAAL,CAAW,kBAAhB,EAAoC;AAClC,QAAA,KAAI,CAAC,aAAL;;AACA,YAAI,KAAI,CAAC,KAAL,CAAW,WAAf,EAA4B,KAAI,CAAC,KAAL,CAAW,WAAX,CAAuB,KAAvB;AAC7B;AACF,KALD;;AAOA,IAAA,KAAA,CAAA,cAAA,GAAwD,UAAC,KAAD,EAAM;AAC5D,UAAI,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAJ,EAAmC;AACjC,QAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,kBAAkB,EAAE;AAAtB,SAAd;;AACA,YAAI,CAAC,QAAQ,CAAC,IAAT,EAAD,IAAoB,KAAI,CAAC,KAAL,CAAW,UAAnC,EACE,KAAK,CAAC,YAAN,CAAmB,UAAnB,GAAgC,KAAI,CAAC,KAAL,CAAW,UAA3C;AACF,YAAI,KAAI,CAAC,KAAL,CAAW,UAAf,EAA2B,KAAI,CAAC,KAAL,CAAW,UAAX,CAAsB,KAAtB;AAC5B;AACF,KAPD;;AASA,IAAA,KAAA,CAAA,eAAA,GAAyD,UAAC,KAAD,EAAM;AAC7D,MAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,kBAAkB,EAAE;AAAtB,OAAd;;AACA,UAAI,KAAI,CAAC,KAAL,CAAW,WAAf,EAA4B,KAAI,CAAC,KAAL,CAAW,WAAX,CAAuB,KAAvB;AAC7B,KAHD;;AAKA,IAAA,KAAA,CAAA,UAAA,GAAoD,UAAC,KAAD,EAAM;AACxD,UAAI,KAAI,CAAC,KAAL,CAAW,MAAX,IAAqB,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAzB,EAAwD;AACtD,YAAM,KAAK,GAAG,KAAK,CAAC,YAAN,GAAqB,KAAK,CAAC,YAAN,CAAmB,KAAxC,GAAgD,IAA9D;;AACA,QAAA,KAAI,CAAC,KAAL,CAAW,MAAX,CAAkB,KAAlB,EAAyB,KAAzB;AACD;;AACD,MAAA,KAAI,CAAC,aAAL;AACD,KAND;;AAQA,IAAA,KAAA,CAAA,iBAAA,GAAuD,UAAC,KAAD,EAAM;AAC3D,UAAI,KAAI,CAAC,KAAL,CAAW,aAAf,EAA8B;AAC5B,QAAA,KAAI,CAAC,KAAL,CAAW,aAAX,CAAyB,KAAzB;AACD;;AACD,MAAA,KAAI,CAAC,aAAL;AACD,KALD;;AAOA,IAAA,KAAA,CAAA,kBAAA,GAAqB,UAAC,KAAD,EAA8B;AACjD,UAAI,KAAJ,EAAW;AACT,QAAA,KAAK,CAAC,mBAAN,CAA0B,WAA1B,EAAuC,KAAI,CAAC,eAA5C;AACA,QAAA,KAAK,CAAC,mBAAN,CAA0B,WAA1B,EAAuC,KAAI,CAAC,eAA5C;AACA,QAAA,KAAK,CAAC,mBAAN,CAA0B,MAA1B,EAAkC,KAAI,CAAC,eAAvC;AACD;AACF,KAND;;AAQA,IAAA,KAAA,CAAA,mBAAA,GAAsB,UAAC,KAAD,EAA8B;AAClD,UAAI,KAAJ,EAAW;AACT,QAAA,KAAK,CAAC,gBAAN,CAAuB,WAAvB,EAAoC,KAAI,CAAC,eAAzC;AACA,QAAA,KAAK,CAAC,gBAAN,CAAuB,WAAvB,EAAoC,KAAI,CAAC,eAAzC;AACA,QAAA,KAAK,CAAC,gBAAN,CAAuB,MAAvB,EAA+B,KAAI,CAAC,eAApC;AACD;AACF,KAND;;AAxGE,IAAA,KAAI,CAAC,gBAAL,GAAwB,CAAxB;AACA,IAAA,KAAI,CAAC,KAAL,GAAa;AAAE,MAAA,iBAAiB,EAAE,KAArB;AAA4B,MAAA,kBAAkB,EAAE;AAAhD,KAAb;;AACD;;AAED,EAAA,QAAA,CAAA,SAAA,CAAA,iBAAA,GAAA,YAAA;AACE,SAAK,mBAAL,CAAyB,KAAK,KAAL,CAAW,KAApC;AACA,SAAK,aAAL;AACA,IAAA,MAAM,CAAC,gBAAP,CAAwB,UAAxB,EAAoC,KAAK,0BAAzC;AACA,IAAA,MAAM,CAAC,gBAAP,CAAwB,MAAxB,EAAgC,KAAK,0BAArC;AACD,GALD;;AAOA,EAAA,QAAA,CAAA,SAAA,CAAA,gCAAA,GAAA,UAAiC,SAAjC,EAAyD;AACvD,QAAI,SAAS,CAAC,KAAV,KAAoB,KAAK,KAAL,CAAW,KAAnC,EAA0C;AACxC,WAAK,aAAL;AACA,WAAK,kBAAL,CAAwB,KAAK,KAAL,CAAW,KAAnC;AACA,WAAK,mBAAL,CAAyB,SAAS,CAAC,KAAnC;AACD;AACF,GAND;;AAQA,EAAA,QAAA,CAAA,SAAA,CAAA,oBAAA,GAAA,YAAA;AACE,SAAK,kBAAL,CAAwB,KAAK,KAAL,CAAW,KAAnC;AACA,IAAA,MAAM,CAAC,mBAAP,CAA2B,UAA3B,EAAuC,KAAK,0BAA5C;AACA,IAAA,MAAM,CAAC,mBAAP,CAA2B,MAA3B,EAAmC,KAAK,0BAAxC;AACD,GAJD;;AA6FA,EAAA,QAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACQ,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QACJ,QAAA,GAAA,EAAA,CAAA,QADI;AAAA,QAEJ,SAAA,GAAA,EAAA,CAAA,SAFI;AAAA,QAGJ,eAAA,GAAA,EAAA,CAAA,eAHI;AAAA,QAIJ,0BAAA,GAAA,EAAA,CAAA,0BAJI;AAAA,QAKJ,2BAAA,GAAA,EAAA,CAAA,2BALI;AAOA,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QAAE,kBAAA,GAAA,EAAA,CAAA,kBAAF;AAAA,QAAsB,iBAAA,GAAA,EAAA,CAAA,iBAAtB;AAEN,QAAI,uBAAuB,GAAG,eAA9B;AACA,QAAI,iBAAJ,EAAuB,uBAAuB,IAAI,MAAI,0BAA/B;AACvB,QAAI,kBAAJ,EAAwB,uBAAuB,IAAI,MAAI,2BAA/B;AAExB,WACE,OAAA,CAAA,OAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AACE,MAAA,SAAS,EAAE,SADb;AAEE,MAAA,UAAU,EAAE,KAAK,cAFnB;AAGE,MAAA,WAAW,EAAE,KAAK,eAHpB;AAIE,MAAA,MAAM,EAAE,KAAK;AAJf,KAAA,EAME,OAAA,CAAA,OAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,MAAA,SAAS,EAAE,uBAAhB;AAAyC,MAAA,OAAO,EAAE,KAAK;AAAvD,KAAA,EACG,QADH,CANF,CADF;AAYD,GA1BD;;AA3KO,EAAA,QAAA,CAAA,IAAA,GAAO,YAAA;AACZ,WAAA,OAAO,MAAP,KAAkB,WAAlB,KACC,MAAM,CAAC,SAAP,CAAiB,SAAjB,CAA2B,OAA3B,CAAmC,MAAnC,MAA+C,CAAC,CAAhD,IACC,MAAM,CAAC,SAAP,CAAiB,UAAjB,CAA4B,OAA5B,CAAoC,UAApC,IAAkD,CAFpD,CAAA;AAEsD,GAHjD;;AAKA,EAAA,QAAA,CAAA,aAAA,GAAgB,UAAC,KAAD,EAA+C;AACpE;AACA,QAAI,QAAQ,GAAG,KAAf;;AACA,QAAI,KAAK,CAAC,YAAV,EAAwB;AACtB,UAAM,KAAK,GAAG,KAAK,CAAC,YAAN,CAAmB,KAAjC;;AACA,WAAK,IAAM,UAAX,IAAyB,KAAzB,EAAgC;AAC9B,YAAI,KAAK,CAAC,UAAD,CAAL,KAAsB,OAA1B,EAAmC;AACjC,UAAA,QAAQ,GAAG,IAAX;AACA;AACD;AACF;AACF;;AACD,WAAO,QAAP;AACD,GAbM;;AAeA,EAAA,QAAA,CAAA,SAAA,GAAY;AACjB,IAAA,SAAS,EAAE,YAAA,CAAA,OAAA,CAAU,MADJ;AAEjB,IAAA,eAAe,EAAE,YAAA,CAAA,OAAA,CAAU,MAFV;AAGjB,IAAA,0BAA0B,EAAE,YAAA,CAAA,OAAA,CAAU,MAHrB;AAIjB,IAAA,2BAA2B,EAAE,YAAA,CAAA,OAAA,CAAU,MAJtB;AAKjB,IAAA,UAAU,EAAE,YAAA,CAAA,OAAA,CAAU,IALL;AAMjB,IAAA,WAAW,EAAE,YAAA,CAAA,OAAA,CAAU,IANN;AAOjB,IAAA,MAAM,EAAE,YAAA,CAAA,OAAA,CAAU,IAPD;AAQjB,IAAA,aAAa,EAAE,YAAA,CAAA,OAAA,CAAU,IARR;AASjB,IAAA,UAAU,EAAE,YAAA,CAAA,OAAA,CAAU,KAAV,CAAgB,CAAC,MAAD,EAAS,MAAT,EAAiB,MAAjB,EAAyB,MAAzB,CAAhB,CATK;AAUjB,IAAA,KAAK,EAAE,UAAC,KAAD,EAAuB,QAAvB,EAAsD,aAAtD,EAA2E;AAChF,UAAM,IAAI,GAAG,KAAK,CAAC,QAAD,CAAlB;;AACA,UAAI,IAAI,IAAI,IAAZ,EAAkB;AAChB,eAAO,IAAI,KAAJ,CACL,6BAA6B,QAA7B,GAAwC,0BAAxC,GAAqE,aAArE,GAAqF,GADhF,CAAP;AAGD;;AACD,UAAI,IAAI,KAAK,QAAT,IAAqB,EAAE,IAAI,YAAY,WAAlB,CAAzB,EAAyD;AACvD,eAAO,IAAI,KAAJ,CACL,oBAAoB,QAApB,GAA+B,wDAD1B,CAAP;AAGD;AACF,KAtBgB;AAuBjB,IAAA,gBAAgB,EAAE,YAAA,CAAA,OAAA,CAAU,IAvBX;AAwBjB,IAAA,gBAAgB,EAAE,YAAA,CAAA,OAAA,CAAU,IAxBX;AAyBjB,IAAA,WAAW,EAAE,YAAA,CAAA,OAAA,CAAU;AAzBN,GAAZ;AA4BA,EAAA,QAAA,CAAA,YAAA,GAAe;AACpB,IAAA,UAAU,EAAE,MADQ;AAEpB,IAAA,KAAK,EAAE,OAAO,MAAP,KAAkB,WAAlB,GAAgC,SAAhC,GAA4C,MAAM,CAAC,QAFtC;AAGpB,IAAA,SAAS,EAAE,WAHS;AAIpB,IAAA,eAAe,EAAE,kBAJG;AAKpB,IAAA,0BAA0B,EAAE,+BALR;AAMpB,IAAA,2BAA2B,EAAE;AANT,GAAf;AAsJT,SAAA,QAAA;AAAC,CAvMD,CAA8B,OAAA,CAAA,OAAA,CAAM,aAApC,CAAA;;AAAa,OAAA,CAAA,QAAA,GAAA,QAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar prop_types_1 = __importDefault(require(\"prop-types\"));\nvar react_1 = __importDefault(require(\"react\"));\nvar FileDrop = /** @class */ (function (_super) {\n    __extends(FileDrop, _super);\n    function FileDrop(props) {\n        var _this = _super.call(this, props) || this;\n        _this.resetDragging = function () {\n            _this.frameDragCounter = 0;\n            _this.setState({ draggingOverFrame: false, draggingOverTarget: false });\n        };\n        _this.handleWindowDragOverOrDrop = function (event) {\n            // This prevents the browser from trying to load whatever file the user dropped on the window\n            event.preventDefault();\n        };\n        _this.handleFrameDrag = function (event) {\n            // Only allow dragging of files\n            if (!FileDrop.eventHasFiles(event))\n                return;\n            // We are listening for events on the 'frame', so every time the user drags over any element in the frame's tree,\n            // the event bubbles up to the frame. By keeping count of how many \"dragenters\" we get, we can tell if they are still\n            // \"draggingOverFrame\" (b/c you get one \"dragenter\" initially, and one \"dragenter\"/one \"dragleave\" for every bubble)\n            // This is far better than a \"dragover\" handler, which would be calling `setState` continuously.\n            _this.frameDragCounter += event.type === 'dragenter' ? 1 : -1;\n            if (_this.frameDragCounter === 1) {\n                _this.setState({ draggingOverFrame: true });\n                if (_this.props.onFrameDragEnter)\n                    _this.props.onFrameDragEnter(event);\n                return;\n            }\n            if (_this.frameDragCounter === 0) {\n                _this.setState({ draggingOverFrame: false });\n                if (_this.props.onFrameDragLeave)\n                    _this.props.onFrameDragLeave(event);\n                return;\n            }\n        };\n        _this.handleFrameDrop = function (event) {\n            if (!_this.state.draggingOverTarget) {\n                _this.resetDragging();\n                if (_this.props.onFrameDrop)\n                    _this.props.onFrameDrop(event);\n            }\n        };\n        _this.handleDragOver = function (event) {\n            if (FileDrop.eventHasFiles(event)) {\n                _this.setState({ draggingOverTarget: true });\n                if (!FileDrop.isIE() && _this.props.dropEffect)\n                    event.dataTransfer.dropEffect = _this.props.dropEffect;\n                if (_this.props.onDragOver)\n                    _this.props.onDragOver(event);\n            }\n        };\n        _this.handleDragLeave = function (event) {\n            _this.setState({ draggingOverTarget: false });\n            if (_this.props.onDragLeave)\n                _this.props.onDragLeave(event);\n        };\n        _this.handleDrop = function (event) {\n            if (_this.props.onDrop && FileDrop.eventHasFiles(event)) {\n                var files = event.dataTransfer ? event.dataTransfer.files : null;\n                _this.props.onDrop(files, event);\n            }\n            _this.resetDragging();\n        };\n        _this.handleTargetClick = function (event) {\n            if (_this.props.onTargetClick) {\n                _this.props.onTargetClick(event);\n            }\n            _this.resetDragging();\n        };\n        _this.stopFrameListeners = function (frame) {\n            if (frame) {\n                frame.removeEventListener('dragenter', _this.handleFrameDrag);\n                frame.removeEventListener('dragleave', _this.handleFrameDrag);\n                frame.removeEventListener('drop', _this.handleFrameDrop);\n            }\n        };\n        _this.startFrameListeners = function (frame) {\n            if (frame) {\n                frame.addEventListener('dragenter', _this.handleFrameDrag);\n                frame.addEventListener('dragleave', _this.handleFrameDrag);\n                frame.addEventListener('drop', _this.handleFrameDrop);\n            }\n        };\n        _this.frameDragCounter = 0;\n        _this.state = { draggingOverFrame: false, draggingOverTarget: false };\n        return _this;\n    }\n    FileDrop.prototype.componentDidMount = function () {\n        this.startFrameListeners(this.props.frame);\n        this.resetDragging();\n        window.addEventListener('dragover', this.handleWindowDragOverOrDrop);\n        window.addEventListener('drop', this.handleWindowDragOverOrDrop);\n    };\n    FileDrop.prototype.UNSAFE_componentWillReceiveProps = function (nextProps) {\n        if (nextProps.frame !== this.props.frame) {\n            this.resetDragging();\n            this.stopFrameListeners(this.props.frame);\n            this.startFrameListeners(nextProps.frame);\n        }\n    };\n    FileDrop.prototype.componentWillUnmount = function () {\n        this.stopFrameListeners(this.props.frame);\n        window.removeEventListener('dragover', this.handleWindowDragOverOrDrop);\n        window.removeEventListener('drop', this.handleWindowDragOverOrDrop);\n    };\n    FileDrop.prototype.render = function () {\n        var _a = this.props, children = _a.children, className = _a.className, targetClassName = _a.targetClassName, draggingOverFrameClassName = _a.draggingOverFrameClassName, draggingOverTargetClassName = _a.draggingOverTargetClassName;\n        var _b = this.state, draggingOverTarget = _b.draggingOverTarget, draggingOverFrame = _b.draggingOverFrame;\n        var fileDropTargetClassName = targetClassName;\n        if (draggingOverFrame)\n            fileDropTargetClassName += \" \" + draggingOverFrameClassName;\n        if (draggingOverTarget)\n            fileDropTargetClassName += \" \" + draggingOverTargetClassName;\n        return (react_1.default.createElement(\"div\", { className: className, onDragOver: this.handleDragOver, onDragLeave: this.handleDragLeave, onDrop: this.handleDrop },\n            react_1.default.createElement(\"div\", { className: fileDropTargetClassName, onClick: this.handleTargetClick }, children)));\n    };\n    FileDrop.isIE = function () {\n        return typeof window !== 'undefined' &&\n            (window.navigator.userAgent.indexOf('MSIE') !== -1 ||\n                window.navigator.appVersion.indexOf('Trident/') > 0);\n    };\n    FileDrop.eventHasFiles = function (event) {\n        // In most browsers this is an array, but in IE11 it's an Object :(\n        var hasFiles = false;\n        if (event.dataTransfer) {\n            var types = event.dataTransfer.types;\n            for (var keyOrIndex in types) {\n                if (types[keyOrIndex] === 'Files') {\n                    hasFiles = true;\n                    break;\n                }\n            }\n        }\n        return hasFiles;\n    };\n    FileDrop.propTypes = {\n        className: prop_types_1.default.string,\n        targetClassName: prop_types_1.default.string,\n        draggingOverFrameClassName: prop_types_1.default.string,\n        draggingOverTargetClassName: prop_types_1.default.string,\n        onDragOver: prop_types_1.default.func,\n        onDragLeave: prop_types_1.default.func,\n        onDrop: prop_types_1.default.func,\n        onTargetClick: prop_types_1.default.func,\n        dropEffect: prop_types_1.default.oneOf(['copy', 'move', 'link', 'none']),\n        frame: function (props, propName, componentName) {\n            var prop = props[propName];\n            if (prop == null) {\n                return new Error('Warning: Required prop `' + propName + '` was not specified in `' + componentName + '`');\n            }\n            if (prop !== document && !(prop instanceof HTMLElement)) {\n                return new Error('Warning: Prop `' + propName + '` must be one of the following: document, HTMLElement!');\n            }\n        },\n        onFrameDragEnter: prop_types_1.default.func,\n        onFrameDragLeave: prop_types_1.default.func,\n        onFrameDrop: prop_types_1.default.func,\n    };\n    FileDrop.defaultProps = {\n        dropEffect: 'copy',\n        frame: typeof window === 'undefined' ? undefined : window.document,\n        className: 'file-drop',\n        targetClassName: 'file-drop-target',\n        draggingOverFrameClassName: 'file-drop-dragging-over-frame',\n        draggingOverTargetClassName: 'file-drop-dragging-over-target',\n    };\n    return FileDrop;\n}(react_1.default.PureComponent));\nexports.FileDrop = FileDrop;\n//# sourceMappingURL=FileDrop.js.map"]},"metadata":{},"sourceType":"script"}